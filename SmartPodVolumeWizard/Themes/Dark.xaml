<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <!-- 普通控件文本颜色 (Label, Button, GroupBox 等) -->
    <SolidColorBrush x:Key="{x:Static SystemColors.ControlTextBrushKey}" Color="White"/>

    <!-- 输入框文本颜色 (TextBox, ListBox, DataGrid 等) -->
    <SolidColorBrush x:Key="{x:Static SystemColors.WindowTextBrushKey}" Color="White"/>

    <SolidColorBrush x:Key="ServiceRunningTextBrush" Color="Green"/>

    <Style TargetType="Window">
        <Setter Property="Background" Value="#202020" />
    </Style>

    <Style TargetType="Button">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border x:Name="RootBorder"
                            Background="#333333"
                            BorderThickness="1"
                            BorderBrush="#9b9b9b"
                            Padding="3">
                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="RootBorder" Property="Background"
                                    Value="#454545" />
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="RootBorder" Property="Background"
                                    Value="#666666" />
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="RootBorder" Property="BorderBrush"
                                    Value="#404040" />
                            <!-- [MARK 1] -->
                            <Setter TargetName="RootBorder" Property="TextElement.Foreground"
                                    Value="#cccccc" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--<Style TargetType="TabControl">
        <Setter Property="Background" Value="#202020" />
    </Style>-->

    <Style TargetType="TabItem">
        <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
        <Setter Property="Background" Value="#2D2D2D"/>
        <!-- 未选中时的背景 -->
        <Setter Property="Foreground" Value="#AAAAAA"/>
        <!-- 未选中时的文字 -->
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Margin" Value="0,0,1,0"/>
        <!-- 标签之间的间距 -->
        <Setter Property="Padding" Value="6,4"/>

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="TabItem">
                    <!-- 标签的容器 -->
                    <Border x:Name="Bd"
                        Background="{TemplateBinding Background}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}"
                        Padding="{TemplateBinding Padding}">
                        <ContentPresenter x:Name="Content"
                                      ContentSource="Header"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"
                                      RecognizesAccessKey="True"
                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                    </Border>

                    <ControlTemplate.Triggers>
                        <!-- 1. 鼠标悬停 (未选中时) -->
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True"/>
                                <Condition Property="IsSelected" Value="False"/>
                            </MultiTrigger.Conditions>
                            <Setter TargetName="Bd" Property="Background" Value="#3E3E3E"/>
                            <Setter Property="Foreground" Value="White"/>
                        </MultiTrigger>

                        <!-- 2. 选中状态 -->
                        <Trigger Property="IsSelected" Value="True">
                            <!-- 选中时背景变深，与下方内容区融为一体 -->
                            <Setter TargetName="Bd" Property="Background" Value="#1E1E1E"/>
                            <!-- 选中时顶部加个亮条，显得现代一点 (可选) -->
                            <Setter TargetName="Bd" Property="BorderThickness" Value="0,2,0,0"/>
                            <Setter TargetName="Bd" Property="BorderBrush" Value="#007ACC"/>
                            <!-- 高亮色，可换 -->
                            <Setter Property="Foreground" Value="White"/>
                        </Trigger>

                        <!-- 3. 禁用状态 -->
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Foreground" Value="#555555"/>
                            <Setter TargetName="Bd" Property="Background" Value="#202020"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="TabControl">
        <!-- 内容区域背景色 (对应 TabItem 选中时的颜色) -->
        <Setter Property="Background" Value="#1E1E1E"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Padding" Value="0"/>
        <!-- 这是一个重要的属性，防止切页时内容重绘导致的闪烁 -->
        <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"/>

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="TabControl">
                    <Grid ClipToBounds="true" SnapsToDevicePixels="true" KeyboardNavigation.TabNavigation="Local">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- 标签栏区域背景 (TabItem 后面那一长条空的区域) -->
                        <Border Background="Transparent">
                            <TabPanel x:Name="HeaderPanel"
                                   Grid.Row="0"
                                   Panel.ZIndex="1"
                                   Margin="0,0,0,-1"
                                   IsItemsHost="true"
                                   KeyboardNavigation.TabIndex="1"
                                   Background="Transparent" />
                        </Border>

                        <!-- 内容区域 -->
                        <Border x:Name="ContentPanel"
                            Grid.Row="1"
                            Background="#202020"
                            KeyboardNavigation.DirectionalNavigation="Contained"
                            KeyboardNavigation.TabIndex="2"
                            KeyboardNavigation.TabNavigation="Local">
                            <ContentPresenter x:Name="PART_SelectedContentHost"
                                          ContentSource="SelectedContent"
                                          Margin="{TemplateBinding Padding}"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                        </Border>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="ListView">
        <Setter Property="Background" Value="#202020" />
        <Setter Property="Foreground" Value="White" />
        <Setter Property="ScrollViewer.CanContentScroll" Value="True"/>
    </Style>

    <Style TargetType="GridViewColumnHeader">
        <Setter Property="Background" Value="#333333" />
        <Setter Property="Foreground" Value="#DDDDDD" />
        <Setter Property="BorderBrush" Value="#555555" />
        <Setter Property="BorderThickness" Value="0,0,1,1" />
        <!-- 右下边框 -->
        <Setter Property="Padding" Value="6,3" />
        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="GridViewColumnHeader">
                    <!-- 自定义扁平化外观 -->
                    <Border Background="{TemplateBinding Background}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}">
                        <Grid>
                            <!-- 内容显示 -->
                            <ContentPresenter Margin="{TemplateBinding Padding}"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          RecognizesAccessKey="True"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                            <!-- 这里可以放一个用于改变列宽的 Gripper，为简化起见省略，不影响基本拖拽 -->
                        </Grid>
                    </Border>

                    <!-- 简单的鼠标悬停效果 -->
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="#454545"/>
                            <Setter Property="Foreground" Value="White"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="Background" Value="#222222"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="ListViewItem">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Foreground" Value="White" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Padding" Value="5,2" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ListViewItem">
                    <Border x:Name="Bd"
                        Background="{TemplateBinding Background}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}"
                        Padding="{TemplateBinding Padding}"
                        SnapsToDevicePixels="true">
                        <!-- 使用 GridViewRowPresenter 来呈现每列的数据 -->
                        <GridViewRowPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                    </Border>
                    <ControlTemplate.Triggers>
                        <!-- 鼠标悬停状态 -->
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="Bd" Property="Background" Value="#3E3E42" />
                        </Trigger>

                        <!-- 选中状态 -->
                        <Trigger Property="IsSelected" Value="True">
                            <Setter TargetName="Bd" Property="Background" Value="#4E4E56" />
                            <!-- 选中背景色 -->
                            <Setter Property="Foreground" Value="White" />
                        </Trigger>

                        <!-- 选中但失去焦点（比如点了别的窗口） -->
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsSelected" Value="True" />
                                <Condition Property="IsKeyboardFocusWithin" Value="False" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="Bd" Property="Background" Value="#333333" />
                        </MultiTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- ============================================================ -->
    <!-- 极简深色滚动条样式 (无箭头按钮)                              -->
    <!-- ============================================================ -->

    <!-- 1. 颜色定义 -->
    <SolidColorBrush x:Key="ScrollBarTrackBackground" Color="#1E1E1E" />
    <!-- 轨道背景 -->
    <SolidColorBrush x:Key="ScrollBarThumb" Color="#4E4E4E" />
    <!-- 滑块平时颜色 -->
    <SolidColorBrush x:Key="ScrollBarThumbHover" Color="#6E6E6E" />
    <!-- 滑块悬停颜色 -->
    <SolidColorBrush x:Key="ScrollBarThumbDragging" Color="#999999" />
    <!-- 滑块拖动颜色 -->

    <!--2. 隐形按钮样式 (用于点击轨道空白处进行翻页，必须存在但不可见)--> 
    <Style x:Key="ScrollBarPageButton" TargetType="{x:Type RepeatButton}">
        <Setter Property="SnapsToDevicePixels" Value="True" />
        <Setter Property="OverridesDefaultStyle" Value="true" />
        <Setter Property="IsTabStop" Value="false" />
        <Setter Property="Focusable" Value="false" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RepeatButton}">
                    <Border Background="Transparent" />
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- 3. 滑块样式 (Thumb) - 现代圆角风格 -->
    <Style x:Key="ScrollBarThumbStyle" TargetType="{x:Type Thumb}">
        <Setter Property="SnapsToDevicePixels" Value="True" />
        <Setter Property="OverridesDefaultStyle" Value="true" />
        <Setter Property="IsTabStop" Value="false" />
        <Setter Property="Focusable" Value="false" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Thumb}">
                    <!-- 圆角矩形滑块，左右/上下留有间隙 -->
                    <Border x:Name="border"
                        Background="{StaticResource ScrollBarThumb}"
                        BorderThickness="0"
                        Margin="2">
                    </Border>
                    <!-- Margin控制滑块不如轨道宽，看起来更精致 -->
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="true">
                            <Setter TargetName="border" Property="Background" 
                                    Value="{StaticResource ScrollBarThumbHover}" />
                        </Trigger>
                        <Trigger Property="IsDragging" Value="true">
                            <Setter TargetName="border" Property="Background" 
                                    Value="{StaticResource ScrollBarThumbDragging}" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- 5. 核心：ScrollBar 主样式 (已修正水平翻页问题) -->
    <Style TargetType="{x:Type ScrollBar}">
        <Setter Property="SnapsToDevicePixels" Value="True" />
        <Setter Property="OverridesDefaultStyle" Value="true" />
        <Setter Property="Background" Value="{StaticResource ScrollBarTrackBackground}" />
        <Setter Property="Width" Value="12"/>
        <Setter Property="Height" Value="12"/>

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ScrollBar}">
                    <Grid Background="{TemplateBinding Background}">

                        <Track x:Name="PART_Track" IsDirectionReversed="true">

                            <!-- 1. 给 Decrease 按钮加上名字 (PageUpButton)，默认命令设为 PageUp -->
                            <Track.DecreaseRepeatButton>
                                <RepeatButton x:Name="PageUpButton"
                                          Style="{StaticResource ScrollBarPageButton}" 
                                          Command="ScrollBar.PageUpCommand" />
                            </Track.DecreaseRepeatButton>

                            <Track.Thumb>
                                <Thumb Style="{StaticResource ScrollBarThumbStyle}" />
                            </Track.Thumb>

                            <!-- 2. 给 Increase 按钮加上名字 (PageDownButton)，默认命令设为 PageDown -->
                            <Track.IncreaseRepeatButton>
                                <RepeatButton x:Name="PageDownButton"
                                          Style="{StaticResource ScrollBarPageButton}" 
                                          Command="ScrollBar.PageDownCommand" />
                            </Track.IncreaseRepeatButton>

                        </Track>
                    </Grid>

                    <ControlTemplate.Triggers>
                        <!-- 水平滚动条处理 -->
                        <Trigger Property="Orientation" Value="Horizontal">
                            <Setter Property="Width" Value="Auto"/>
                            <Setter Property="Height" Value="12"/>
                            <Setter TargetName="PART_Track" Property="IsDirectionReversed" Value="False"/>

                            <!-- 【核心修复】当变为水平时，修改按钮的 Command 为向左/向右翻页 -->
                            <Setter TargetName="PageUpButton" Property="Command" Value="ScrollBar.PageLeftCommand" />
                            <Setter TargetName="PageDownButton" Property="Command" Value="ScrollBar.PageRightCommand" />
                        </Trigger>

                        <!-- 垂直滚动条处理 -->
                        <Trigger Property="Orientation" Value="Vertical">
                            <Setter Property="Width" Value="12"/>
                            <Setter Property="Height" Value="Auto"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    
</ResourceDictionary>